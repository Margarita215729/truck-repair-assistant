(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[161],{3875:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(5155),i=s(2115),r=s(6045);class n{async diagnoseTruckIssue(e){let t=[];if("azure-openai"===this.config.primaryProvider)try{console.log("\uD83D\uDD0D Attempting diagnosis with Azure OpenAI (primary)...");let t=await this.withTimeout(this.azureService.diagnoseTruckIssue(e),this.config.timeout);return console.log("✅ Azure OpenAI diagnosis successful"),{result:t,provider:"azure-openai",fallbackUsed:!1}}catch(s){let e={provider:"azure-openai",error:s instanceof Error?s:Error(String(s)),context:"Primary diagnosis attempt"};t.push(e),console.warn("⚠️ Azure OpenAI failed:",e.error.message)}if(this.config.fallbackEnabled)try{console.log("\uD83D\uDD04 Falling back to GitHub Models...");let s=await this.withTimeout(this.diagnoseWithGitHubModels(e),this.config.timeout);return console.log("✅ GitHub Models diagnosis successful (fallback)"),{result:s,provider:"github-models",fallbackUsed:!0,errors:t}}catch(s){let e={provider:"github-models",error:s instanceof Error?s:Error(String(s)),context:"Fallback diagnosis attempt"};t.push(e),console.error("❌ GitHub Models also failed:",e.error.message)}throw Error("All AI providers failed: ".concat(t.map(e=>"".concat(e.provider,": ").concat(e.error.message)).join(", ")))}async chat(e){let t=[];try{console.log("\uD83D\uDCAC Attempting chat with Azure OpenAI...");let t=await this.withTimeout(this.azureService.chatWithAssistant(e),this.config.timeout);return console.log("✅ Azure OpenAI chat successful"),{result:t,provider:"azure-openai",fallbackUsed:!1}}catch(s){let e={provider:"azure-openai",error:s instanceof Error?s:Error(String(s)),context:"Chat attempt"};t.push(e),console.warn("⚠️ Azure OpenAI chat failed:",e.error.message)}if(this.config.fallbackEnabled)try{console.log("\uD83D\uDD04 Falling back to GitHub Models for chat...");let s=await this.withTimeout(this.chatWithGitHubModels(e),this.config.timeout);return console.log("✅ GitHub Models chat successful (fallback)"),{result:s,provider:"github-models",fallbackUsed:!0,errors:t}}catch(s){let e={provider:"github-models",error:s instanceof Error?s:Error(String(s)),context:"Fallback chat attempt"};t.push(e),console.error("❌ GitHub Models chat also failed:",e.error.message)}throw Error("All chat providers failed: ".concat(t.map(e=>"".concat(e.provider,": ").concat(e.error.message)).join(", ")))}async streamChat(e,t){try{for await(let s of(console.log("\uD83C\uDF0A Attempting streaming chat with Azure OpenAI..."),await this.azureService.streamChatResponse(e)))t(s);console.log("✅ Azure OpenAI streaming successful")}catch(s){if(console.warn("⚠️ Azure OpenAI streaming failed, falling back to regular chat:",s),this.config.fallbackEnabled)try{let s=await this.chatWithGitHubModels(e);t(s),console.log("✅ Fallback to GitHub Models successful")}catch(e){throw console.error("❌ Both streaming and fallback failed:",e),Error("Streaming failed: ".concat(s,". Fallback also failed: ").concat(e))}else throw s}}async checkHealth(){let e=[];try{let t=Date.now(),s=await this.azureService.healthCheck(),a=Date.now()-t;e.push({isHealthy:s,service:"azure-openai",latency:a})}catch(t){e.push({isHealthy:!1,service:"azure-openai",error:t instanceof Error?t.message:"Unknown error"})}try{let t=Date.now();await this.testGitHubModelsConnection();let s=Date.now()-t;e.push({isHealthy:!0,service:"github-models",latency:s})}catch(t){e.push({isHealthy:!1,service:"github-models",error:t instanceof Error?t.message:"Unknown error"})}return e}async withTimeout(e,t){return Promise.race([e,new Promise((e,s)=>{setTimeout(()=>s(Error("Operation timed out after ".concat(t,"ms"))),t)})])}async diagnoseWithGitHubModels(e){var t,s;let a="TRUCK INFORMATION:\nMake: ".concat(e.truck.make,"\nModel: ").concat(e.truck.model,"\nYear: ").concat(e.truck.year||(e.truck.years?e.truck.years[e.truck.years.length-1]:"Unknown"),"\nEngine: ").concat(e.truck.engine,"\n\nREPORTED SYMPTOMS:\n").concat(e.symptoms.map((e,t)=>"".concat(t+1,". ").concat(e)).join("\n"),"\n\n").concat(e.additionalInfo?"ADDITIONAL INFORMATION:\n".concat(e.additionalInfo,"\n"):"","\n\nURGENCY LEVEL: ").concat(e.urgency||"medium","\n\nPlease provide a comprehensive diagnosis including:\n1. Most likely diagnosis with confidence level (1-10)\n2. Step-by-step repair instructions\n3. Required tools and equipment\n4. Estimated time and cost\n5. Important safety warnings\n6. Urgency assessment"),i=await fetch("".concat(this.githubEndpoint,"/chat/completions"),{method:"POST",headers:{Authorization:"Bearer ".concat(this.githubToken),"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"system",content:'You are an expert truck mechanic with over 20 years of experience specializing in commercial vehicle diagnostics and repair. You have extensive knowledge of:\n\n- Heavy-duty diesel engines (Caterpillar, Cummins, Detroit Diesel, PACCAR, Volvo, Mack)\n- Emissions systems (DPF, SCR, EGR, DEF)\n- Transmission systems (manual, automatic, AMT)\n- Air brake systems and pneumatics\n- Electrical and electronic systems\n- Preventive maintenance schedules\n\nProvide accurate, practical repair guidance with safety considerations. Always include cost estimates and time requirements.\n\nRespond ONLY with valid JSON in this exact format:\n{\n  "diagnosis": "string - detailed diagnosis",\n  "confidence": number (1-10),\n  "repairSteps": ["step 1", "step 2", "step 3"],\n  "requiredTools": ["tool 1", "tool 2"],\n  "estimatedTime": "string - time estimate",\n  "estimatedCost": "string - cost range",\n  "safetyWarnings": ["warning 1", "warning 2"],\n  "urgencyLevel": "low | medium | high"\n}'},{role:"user",content:a}],model:"gpt-4o",temperature:.1,max_tokens:2e3})});if(!i.ok)throw Error("GitHub Models API error: ".concat(i.status," ").concat(i.statusText));let r=null==(s=(await i.json()).choices[0])||null==(t=s.message)?void 0:t.content;if(!r)throw Error("No response content from GitHub Models");try{return JSON.parse(r)}catch(e){throw console.error("Failed to parse GitHub Models response:",r),Error("Invalid JSON response from GitHub Models")}}async chatWithGitHubModels(e){var t,s;let a=await fetch("".concat(this.githubEndpoint,"/chat/completions"),{method:"POST",headers:{Authorization:"Bearer ".concat(this.githubToken),"Content-Type":"application/json"},body:JSON.stringify({messages:e,model:"gpt-4o",temperature:.7,max_tokens:1500})});if(!a.ok)throw Error("GitHub Models API error: ".concat(a.status," ").concat(a.statusText));return(null==(s=(await a.json()).choices[0])||null==(t=s.message)?void 0:t.content)||""}async testGitHubModelsConnection(){let e=await fetch("".concat(this.githubEndpoint,"/chat/completions"),{method:"POST",headers:{Authorization:"Bearer ".concat(this.githubToken),"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"user",content:"Test connection"}],model:"gpt-4o",max_tokens:10})});if(!e.ok)throw Error("GitHub Models connection test failed: ".concat(e.status))}async generateResponse(e){return(await this.chat(e)).result}async analyzeAudio(e,t){let s={truck:t,symptoms:["Audio analysis: "+e.substring(0,100)],additionalInfo:"Audio diagnostic data provided",urgency:"medium"};return(await this.diagnoseTruckIssue(s)).result}setPrimaryProvider(e){this.config.primaryProvider=e}setFallbackEnabled(e){this.config.fallbackEnabled=e}setTimeout(e){this.config.timeout=e}getConfig(){return{...this.config}}constructor(e){this.azureService=new r.J,this.githubToken="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",this.githubEndpoint="https://models.inference.ai.azure.com",this.config={primaryProvider:"azure-openai",fallbackEnabled:!0,timeout:3e4,...e}}}let o=new n;var c=s(3691);let l=()=>{let[e,t]=(0,i.useState)({}),[s,r]=(0,i.useState)(null),[n,l]=(0,i.useState)([]),[d,h]=(0,i.useState)(""),u={id:"test-truck",make:"Peterbilt",model:"379",year:2020,engine:"Caterpillar C15"};(0,i.useEffect)(()=>{m()},[]);let g=async(e,s)=>{r(e);let a=Date.now();try{let i=await s(),r=Date.now()-a;t(t=>({...t,[e]:{success:!0,duration:r,provider:i.provider,fallbackUsed:i.fallbackUsed,data:i.result||i}}))}catch(i){let s=Date.now()-a;t(t=>({...t,[e]:{success:!1,duration:s,error:i instanceof Error?i.message:"Unknown error"}}))}finally{r(null)}},m=async()=>{await g("health-check",async()=>{let e=await o.checkHealth();return l(e),e})},p=async()=>{let e={truck:u,symptoms:["Engine making unusual noise","Reduced power","Black smoke from exhaust"],additionalInfo:"Truck has been driven for 500,000 miles. Last maintenance was 3 months ago.",urgency:"medium"};await g("enhanced-diagnosis",async()=>await o.diagnoseTruckIssue(e))},b=async()=>{let e={truck:u,symptoms:["Engine overheating","Coolant leak","Temperature gauge in red zone"],additionalInfo:"Truck stopped on highway due to overheating warning.",urgency:"high"};await g("legacy-diagnosis",async()=>await c.ut.diagnoseTruckIssue(e))},y=async()=>{let e=[{role:"user",content:"What are the most common issues with Caterpillar C15 engines?"}];await g("enhanced-chat",async()=>await o.chat(e))},f=async()=>{h("");let e=[{role:"user",content:"Explain the process of diagnosing a diesel engine that has black smoke coming from the exhaust."}];await g("streaming-chat",async()=>new Promise((t,s)=>{let a="";o.streamChat(e,e=>{h(a+=e)}).then(()=>{t(a)}).catch(s)}))},x=async()=>{await g("config-changes",async()=>{let e=o.getConfig();o.setPrimaryProvider("github-models");let t=o.getConfig();return o.setPrimaryProvider(e.primaryProvider),{originalConfig:e,configAfterChange:t,restored:!0}})},w=async()=>{await g("timeout-test",async()=>{let e=o.getConfig().timeout;o.setTimeout(1);try{return await o.diagnoseTruckIssue({truck:u,symptoms:["Test timeout"],urgency:"low"}),{timeoutTriggered:!1}}catch(e){return{timeoutTriggered:!0,error:e instanceof Error?e.message:"Unknown error"}}finally{o.setTimeout(e)}})},v=(e,t)=>t?(0,a.jsxs)("div",{className:"p-4 rounded-lg border ".concat(t.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("h4",{className:"font-semibold",children:e}),(0,a.jsx)("span",{className:"px-2 py-1 rounded text-sm ".concat(t.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t.success?"PASS":"FAIL"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,a.jsxs)("div",{children:["Duration: ",t.duration,"ms"]}),t.provider&&(0,a.jsxs)("div",{children:["Provider: ",t.provider]}),void 0!==t.fallbackUsed&&(0,a.jsxs)("div",{children:["Fallback used: ",t.fallbackUsed?"Yes":"No"]}),t.error&&(0,a.jsxs)("div",{className:"text-red-600 bg-red-50 p-2 rounded",children:["Error: ",t.error]})]})]}):null;return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-8",children:"\uD83D\uDD27 Comprehensive AI Integration Test Suite"}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,a.jsxs)("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:["\uD83C\uDFE5 Health Status",(0,a.jsx)("button",{onClick:m,disabled:"health-check"===s,className:"ml-4 px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"health-check"===s?"Checking...":"Refresh"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(e=>(0,a.jsxs)("div",{className:"p-4 rounded-lg border ".concat(e.isHealthy?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:[(0,a.jsx)("h3",{className:"font-semibold capitalize",children:e.service.replace("-"," ")}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,a.jsxs)("div",{children:["Status: ",e.isHealthy?"✅ Healthy":"❌ Unhealthy"]}),e.latency&&(0,a.jsxs)("div",{children:["Latency: ",e.latency,"ms"]}),e.error&&(0,a.jsxs)("div",{className:"text-red-600",children:["Error: ",e.error]})]})]},e.service))})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"\uD83E\uDDEA Test Controls"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[(0,a.jsx)("button",{onClick:p,disabled:"enhanced-diagnosis"===s,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50",children:"enhanced-diagnosis"===s?"Testing...":"Enhanced Diagnosis"}),(0,a.jsx)("button",{onClick:b,disabled:"legacy-diagnosis"===s,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50",children:"legacy-diagnosis"===s?"Testing...":"Legacy Diagnosis"}),(0,a.jsx)("button",{onClick:y,disabled:"enhanced-chat"===s,className:"bg-purple-600 text-white px-4 py-2 rounded-md hover:bg-purple-700 disabled:opacity-50",children:"enhanced-chat"===s?"Testing...":"Enhanced Chat"}),(0,a.jsx)("button",{onClick:f,disabled:"streaming-chat"===s,className:"bg-orange-600 text-white px-4 py-2 rounded-md hover:bg-orange-700 disabled:opacity-50",children:"streaming-chat"===s?"Streaming...":"Streaming Chat"}),(0,a.jsx)("button",{onClick:x,disabled:"config-changes"===s,className:"bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 disabled:opacity-50",children:"config-changes"===s?"Testing...":"Config Changes"}),(0,a.jsx)("button",{onClick:w,disabled:"timeout-test"===s,className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 disabled:opacity-50",children:"timeout-test"===s?"Testing...":"Timeout Test"})]})]}),d&&(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"\uD83C\uDF0A Streaming Output"}),(0,a.jsx)("div",{className:"bg-gray-100 p-4 rounded-lg",children:(0,a.jsx)("pre",{className:"whitespace-pre-wrap text-sm",children:d})})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"\uD83D\uDCCA Test Results"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(e).map(e=>{let[t,s]=e;return(0,a.jsx)("div",{children:v(t,s)},t)})})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mt-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"⚙️ Current Configuration"}),(0,a.jsx)("div",{className:"bg-gray-100 p-4 rounded-lg",children:(0,a.jsx)("pre",{className:"text-sm",children:JSON.stringify(o.getConfig(),null,2)})})]})]})})}},6031:(e,t,s)=>{Promise.resolve().then(s.bind(s,3875))}},e=>{var t=t=>e(e.s=t);e.O(0,[882,691,441,684,358],()=>t(6031)),_N_E=e.O()}]);